@page "/fileview"
@using Microsoft.AspNetCore.Authorization
@attribute [Authorize(Roles ="User, Administrator")]
@inject NavigationManager Navigation

<h3>File View</h3>
<button @onclick="navigateBack">back</button>


@code{
    
    private string _path;

    private string _backroute;

    protected override void OnInitialized()
    {
        bool forceBackNav = false;
        // Get the URI
        var uri = Navigation.Uri;

        // Parse the query string
        var query = Microsoft.AspNetCore.WebUtilities.QueryHelpers.ParseQuery(new Uri(uri).Query);

        // Extract specific query parameters
        if (query.TryGetValue("path", out var pathValue))
        {
            _path = pathValue;
        }
        else
        {
            forceBackNav = true;
        }

        if (query.TryGetValue("back_path", out var backRouteValue))
        {
            _backroute = backRouteValue;
        }
        else
        {
            _backroute = "";
        }

        if (forceBackNav)
        {
            var url = "/files" + "?back_path=" + _backroute;
            
            Navigation.NavigateTo(url);
        }
       
    }
    
    private void navigateBack()
    {
        string url = "/files" + "?back_path=" + _backroute;
        Navigation.NavigateTo(url);
    }

}